/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.134.1
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */
import{a as st}from"./chunk-7ZWGKBJM.js";import{b as xt,c as ht,d as et}from"./chunk-UHBRQJNJ.js";import{a as tt}from"./chunk-XNSUDY5I.js";import{a as h,b as Y,c as g,d as gt}from"./chunk-HMXGNDLA.js";import{a as X}from"./chunk-V7XA5C77.js";import{a as ft}from"./chunk-DGHOUIXA.js";import{b as A}from"./chunk-U7V5VQ2T.js";import{e as F}from"./chunk-NVZ5L4JK.js";var ct={CLOCKWISE:ft.CW,COUNTER_CLOCKWISE:ft.CCW,validate:function(t){return t===ct.CLOCKWISE||t===ct.COUNTER_CLOCKWISE}},at=Object.freeze(ct);function mt(t,e,n=2){let r,i,a,u=e&&e.length,l=u?e[0]*n:t.length,x=wt(t,0,l,n,!0),o=[];if(!x||x.next===x.prev)return o;if(u&&(x=It(t,e,x,n)),t.length>80*n){r=t[0],i=t[1];let e=r,u=i;for(let a=n;a<l;a+=n){let n=t[a],l=t[a+1];n<r&&(r=n),l<i&&(i=l),n>e&&(e=n),l>u&&(u=l)}a=Math.max(e-r,u-i),a=0!==a?32767/a:0}return rt(x,o,n,r,i,a,0),o}function wt(t,e,n,r,i){let a;if(i===Vt(t,e,n,r)>0)for(let u=e;u<n;u+=r)a=vt(u/r|0,t[u],t[u+1],a);else for(let u=n-r;u>=e;u-=r)a=vt(u/r|0,t[u],t[u+1],a);return a&&K(a,a.next)&&(ot(a),a=a.next),a}function N(t,e){if(!t)return t;e||(e=t);let n,r=t;do{if(n=!1,r.steiner||!K(r,r.next)&&0!==w(r.prev,r,r.next))r=r.next;else{if(ot(r),r=e=r.prev,r===r.next)break;n=!0}}while(n||r!==e);return e}function rt(t,e,n,r,i,a,u){if(!t)return;!u&&a&&Nt(t,r,i,a);let l=t;for(;t.prev!==t.next;){let x=t.prev,o=t.next;if(a?Rt(t,r,i,a):Pt(t))e.push(x.i,t.i,o.i),ot(t),t=o.next,l=o.next;else if(t=o,t===l){u?1===u?(t=zt(N(t),e),rt(t,e,n,r,i,a,2)):2===u&&Bt(t,e,n,r,i,a):rt(N(t),e,n,r,i,a,1);break}}}function Pt(t){let e=t.prev,n=t,r=t.next;if(w(e,n,r)>=0)return!1;let i=e.x,a=n.x,u=r.x,l=e.y,x=n.y,o=r.y,h=Math.min(i,a,u),p=Math.min(l,x,o),y=Math.max(i,a,u),s=Math.max(l,x,o),f=r.next;for(;f!==e;){if(f.x>=h&&f.x<=y&&f.y>=p&&f.y<=s&&nt(i,l,a,x,u,o,f.x,f.y)&&w(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Rt(t,e,n,r){let i=t.prev,a=t,u=t.next;if(w(i,a,u)>=0)return!1;let l=i.x,x=a.x,o=u.x,h=i.y,p=a.y,y=u.y,s=Math.min(l,x,o),f=Math.min(h,p,y),c=Math.max(l,x,o),m=Math.max(h,p,y),d=pt(s,f,e,n,r),g=pt(c,m,e,n,r),v=t.prevZ,A=t.nextZ;for(;v&&v.z>=d&&A&&A.z<=g;){if(v.x>=s&&v.x<=c&&v.y>=f&&v.y<=m&&v!==i&&v!==u&&nt(l,h,x,p,o,y,v.x,v.y)&&w(v.prev,v,v.next)>=0||(v=v.prevZ,A.x>=s&&A.x<=c&&A.y>=f&&A.y<=m&&A!==i&&A!==u&&nt(l,h,x,p,o,y,A.x,A.y)&&w(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;v&&v.z>=d;){if(v.x>=s&&v.x<=c&&v.y>=f&&v.y<=m&&v!==i&&v!==u&&nt(l,h,x,p,o,y,v.x,v.y)&&w(v.prev,v,v.next)>=0)return!1;v=v.prevZ}for(;A&&A.z<=g;){if(A.x>=s&&A.x<=c&&A.y>=f&&A.y<=m&&A!==i&&A!==u&&nt(l,h,x,p,o,y,A.x,A.y)&&w(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function zt(t,e){let n=t;do{let r=n.prev,i=n.next.next;!K(r,i)&&bt(r,n,n.next,i)&&it(r,i)&&it(i,r)&&(e.push(r.i,n.i,i.i),ot(n),ot(n.next),n=t=i),n=n.next}while(n!==t);return N(n)}function Bt(t,e,n,r,i,a){let u=t;do{let t=u.next.next;for(;t!==u.prev;){if(u.i!==t.i&&_t(u,t)){let l=Mt(u,t);return u=N(u,u.next),l=N(l,l.next),rt(u,e,n,r,i,a,0),void rt(l,e,n,r,i,a,0)}t=t.next}u=u.next}while(u!==t)}function It(t,e,n,r){let i=[];for(let a=0,u=e.length;a<u;a++){let n=e[a]*r,l=a<u-1?e[a+1]*r:t.length,x=wt(t,n,l,r,!1);x===x.next&&(x.steiner=!0),i.push(Ut(x))}i.sort(Wt);for(let a=0;a<i.length;a++)n=$t(i[a],n);return n}function Wt(t,e){let n=t.x-e.x;if(0===n&&(n=t.y-e.y,0===n)){let r=(t.next.y-t.y)/(t.next.x-t.x),i=(e.next.y-e.y)/(e.next.x-e.x);n=r-i}return n}function $t(t,e){let n=Gt(t,e);if(!n)return e;let r=Mt(n,t);return N(r,r.next),N(n,n.next)}function Gt(t,e){let n,r=e,i=t.x,a=t.y,u=-1/0;if(K(t,r))return r;do{if(K(t,r.next))return r.next;if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let t=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=i&&t>u&&(u=t,n=r.x<r.next.x?r:r.next,t===i))return n}r=r.next}while(r!==e);if(!n)return null;let l=n,x=n.x,o=n.y,h=1/0;r=n;do{if(i>=r.x&&r.x>=x&&i!==r.x&&St(a<o?i:u,a,x,o,a<o?u:i,a,r.x,r.y)){let e=Math.abs(a-r.y)/(i-r.x);it(r,t)&&(e<h||e===h&&(r.x>n.x||r.x===n.x&&Ht(n,r)))&&(n=r,h=e)}r=r.next}while(r!==l);return n}function Ht(t,e){return w(t.prev,t,e.prev)<0&&w(e.next,t,t.next)<0}function Nt(t,e,n,r){let i=t;do{0===i.z&&(i.z=pt(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,kt(i)}function kt(t){let e,n=1;do{let r,i=t;t=null;let a=null;for(e=0;i;){e++;let u=i,l=0;for(let t=0;t<n&&(l++,u=u.nextZ,u);t++);let x=n;for(;l>0||x>0&&u;)0!==l&&(0===x||!u||i.z<=u.z)?(r=i,i=i.nextZ,l--):(r=u,u=u.nextZ,x--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=u}a.nextZ=null,n*=2}while(e>1);return t}function pt(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function Ut(t){let e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function St(t,e,n,r,i,a,u,l){return(i-u)*(e-l)>=(t-u)*(a-l)&&(t-u)*(r-l)>=(n-u)*(e-l)&&(n-u)*(a-l)>=(i-u)*(r-l)}function nt(t,e,n,r,i,a,u,l){return!(t===u&&e===l)&&St(t,e,n,r,i,a,u,l)}function _t(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Kt(t,e)&&(it(t,e)&&it(e,t)&&jt(t,e)&&(w(t.prev,t,e.prev)||w(t,e.prev,e))||K(t,e)&&w(t.prev,t,t.next)>0&&w(e.prev,e,e.next)>0)}function w(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function K(t,e){return t.x===e.x&&t.y===e.y}function bt(t,e,n,r){let i=lt(w(t,e,n)),a=lt(w(t,e,r)),u=lt(w(n,r,t)),l=lt(w(n,r,e));return!!(i!==a&&u!==l||0===i&&ut(t,n,e)||0===a&&ut(t,r,e)||0===u&&ut(n,t,r)||0===l&&ut(n,e,r))}function ut(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function lt(t){return t>0?1:t<0?-1:0}function Kt(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&bt(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function it(t,e){return w(t.prev,t,t.next)<0?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:w(t,e,t.prev)<0||w(t,t.next,e)<0}function jt(t,e){let n=t,r=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function Mt(t,e){let n=yt(t.i,t.x,t.y),r=yt(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,a.next=r,r.prev=a,r}function vt(t,e,n,r){let i=yt(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ot(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function yt(t,e,n){return{i:t,x:e,y:n,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Vt(t,e,n,r){let i=0;for(let a=e,u=n-r;a<n;a+=r)i+=(t[u]-t[a])*(t[a+1]+t[u+1]),u=a;return i}var qt=new h,Jt=new h,B={computeArea2D:function(t){A.defined("positions",t),A.typeOf.number.greaterThanOrEquals("positions.length",t.length,3);let e=t.length,n=0;for(let r=e-1,i=0;i<e;r=i++){let e=t[r],a=t[i];n+=e.x*a.y-a.x*e.y}return.5*n},computeWindingOrder2D:function(t){return B.computeArea2D(t)>0?at.COUNTER_CLOCKWISE:at.CLOCKWISE},triangulate:function(t,e){A.defined("positions",t);let n=g.packArray(t);return mt(n,e,2)}},Tt=new h,Ot=new h,Zt=new h,At=new h,Ct=new h,Et=new h,R=new h,Lt=new g,Ft=new g,Dt=new g,j=new g;B.computeSubdivision=function(t,e,n,r,i){i=i??X.RADIANS_PER_DEGREE;let a=F(r);A.typeOf.object("ellipsoid",t),A.defined("positions",e),A.defined("indices",n),A.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),A.typeOf.number.equals("indices.length % 3","0",n.length%3,0),A.typeOf.number.greaterThan("granularity",i,0);let u,l=n.slice(0),x=e.length,o=new Array(3*x),p=new Array(2*x),y=0,s=0;for(u=0;u<x;u++){let t=e[u];if(o[y++]=t.x,o[y++]=t.y,o[y++]=t.z,a){let t=r[u];p[s++]=t.x,p[s++]=t.y}}let f=[],c={},m=t.maximumRadius,d=X.chordLength(i,m),v=d*d;for(;l.length>0;){let t,e,n,r=l.pop(),i=l.pop(),x=l.pop(),y=h.fromArray(o,3*x,Tt),s=h.fromArray(o,3*i,Ot),d=h.fromArray(o,3*r,Zt);a&&(t=g.fromArray(p,2*x,Lt),e=g.fromArray(p,2*i,Ft),n=g.fromArray(p,2*r,Dt));let w,A,b,S=h.multiplyByScalar(h.normalize(y,At),m,At),M=h.multiplyByScalar(h.normalize(s,Ct),m,Ct),Z=h.multiplyByScalar(h.normalize(d,Et),m,Et),O=h.magnitudeSquared(h.subtract(S,M,R)),E=h.magnitudeSquared(h.subtract(M,Z,R)),B=h.magnitudeSquared(h.subtract(Z,S,R)),C=Math.max(O,E,B);C>v?O===C?(w=`${Math.min(x,i)} ${Math.max(x,i)}`,u=c[w],F(u)||(A=h.add(y,s,R),h.multiplyByScalar(A,.5,A),o.push(A.x,A.y,A.z),u=o.length/3-1,c[w]=u,a&&(b=g.add(t,e,j),g.multiplyByScalar(b,.5,b),p.push(b.x,b.y))),l.push(x,u,r),l.push(u,i,r)):E===C?(w=`${Math.min(i,r)} ${Math.max(i,r)}`,u=c[w],F(u)||(A=h.add(s,d,R),h.multiplyByScalar(A,.5,A),o.push(A.x,A.y,A.z),u=o.length/3-1,c[w]=u,a&&(b=g.add(e,n,j),g.multiplyByScalar(b,.5,b),p.push(b.x,b.y))),l.push(i,u,x),l.push(u,r,x)):B===C&&(w=`${Math.min(r,x)} ${Math.max(r,x)}`,u=c[w],F(u)||(A=h.add(d,y,R),h.multiplyByScalar(A,.5,A),o.push(A.x,A.y,A.z),u=o.length/3-1,c[w]=u,a&&(b=g.add(n,t,j),g.multiplyByScalar(b,.5,b),p.push(b.x,b.y))),l.push(r,u,i),l.push(u,x,i)):(f.push(x),f.push(i),f.push(r))}let w={attributes:{position:new et({componentDatatype:tt.DOUBLE,componentsPerAttribute:3,values:o})},indices:f,primitiveType:xt.TRIANGLES};return a&&(w.attributes.st=new et({componentDatatype:tt.FLOAT,componentsPerAttribute:2,values:p})),new ht(w)};var Qt=new Y,Xt=new Y,Yt=new Y,dt=new Y;B.computeRhumbLineSubdivision=function(t,e,n,r,i){i=i??X.RADIANS_PER_DEGREE;let a=F(r);A.typeOf.object("ellipsoid",t),A.defined("positions",e),A.defined("indices",n),A.typeOf.number.greaterThanOrEquals("indices.length",n.length,3),A.typeOf.number.equals("indices.length % 3","0",n.length%3,0),A.typeOf.number.greaterThan("granularity",i,0);let u,l=n.slice(0),x=e.length,o=new Array(3*x),p=new Array(2*x),y=0,s=0;for(u=0;u<x;u++){let t=e[u];if(o[y++]=t.x,o[y++]=t.y,o[y++]=t.z,a){let t=r[u];p[s++]=t.x,p[s++]=t.y}}let f=[],c={},m=t.maximumRadius,d=X.chordLength(i,m),v=new st(void 0,void 0,t),w=new st(void 0,void 0,t),b=new st(void 0,void 0,t);for(;l.length>0;){let e,n,r,i=l.pop(),x=l.pop(),y=l.pop(),s=h.fromArray(o,3*y,Tt),m=h.fromArray(o,3*x,Ot),A=h.fromArray(o,3*i,Zt);a&&(e=g.fromArray(p,2*y,Lt),n=g.fromArray(p,2*x,Ft),r=g.fromArray(p,2*i,Dt));let S=t.cartesianToCartographic(s,Qt),M=t.cartesianToCartographic(m,Xt),Z=t.cartesianToCartographic(A,Yt);v.setEndPoints(S,M);let O=v.surfaceDistance;w.setEndPoints(M,Z);let E=w.surfaceDistance;b.setEndPoints(Z,S);let B,C,z,T,D,N=b.surfaceDistance,L=Math.max(O,E,N);L>d?O===L?(B=`${Math.min(y,x)} ${Math.max(y,x)}`,u=c[B],F(u)||(C=v.interpolateUsingFraction(.5,dt),z=.5*(S.height+M.height),T=h.fromRadians(C.longitude,C.latitude,z,t,R),o.push(T.x,T.y,T.z),u=o.length/3-1,c[B]=u,a&&(D=g.add(e,n,j),g.multiplyByScalar(D,.5,D),p.push(D.x,D.y))),l.push(y,u,i),l.push(u,x,i)):E===L?(B=`${Math.min(x,i)} ${Math.max(x,i)}`,u=c[B],F(u)||(C=w.interpolateUsingFraction(.5,dt),z=.5*(M.height+Z.height),T=h.fromRadians(C.longitude,C.latitude,z,t,R),o.push(T.x,T.y,T.z),u=o.length/3-1,c[B]=u,a&&(D=g.add(n,r,j),g.multiplyByScalar(D,.5,D),p.push(D.x,D.y))),l.push(x,u,y),l.push(u,i,y)):N===L&&(B=`${Math.min(i,y)} ${Math.max(i,y)}`,u=c[B],F(u)||(C=b.interpolateUsingFraction(.5,dt),z=.5*(Z.height+S.height),T=h.fromRadians(C.longitude,C.latitude,z,t,R),o.push(T.x,T.y,T.z),u=o.length/3-1,c[B]=u,a&&(D=g.add(r,e,j),g.multiplyByScalar(D,.5,D),p.push(D.x,D.y))),l.push(i,u,x),l.push(u,y,x)):(f.push(y),f.push(x),f.push(i))}let S={attributes:{position:new et({componentDatatype:tt.DOUBLE,componentsPerAttribute:3,values:o})},indices:f,primitiveType:xt.TRIANGLES};return a&&(S.attributes.st=new et({componentDatatype:tt.FLOAT,componentsPerAttribute:2,values:p})),new ht(S)},B.scaleToGeodeticHeight=function(t,e,n,r){n=n??gt.default;let i=qt,a=Jt;if(e=e??0,r=r??!0,F(t)){let u=t.length;for(let l=0;l<u;l+=3)h.fromArray(t,l,a),r&&(a=n.scaleToGeodeticSurface(a,a)),0!==e&&(i=n.geodeticSurfaceNormal(a,i),h.multiplyByScalar(i,e,i),h.add(a,i,a)),t[l]=a.x,t[l+1]=a.y,t[l+2]=a.z}return t};var de=B;export{at as a,de as b};