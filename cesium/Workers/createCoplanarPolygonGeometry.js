/**
 * @license
 * Cesium - https://github.com/CesiumGS/cesium
 * Version 1.134.1
 *
 * Copyright 2011-2022 Cesium Contributors
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * Columbus View (Pat. Pend.)
 *
 * Portions licensed separately.
 * See https://github.com/CesiumGS/cesium/blob/main/LICENSE.md for full licensing details.
 */
import{a as et}from"./chunk-ELLIJ4U5.js";import{a as Q}from"./chunk-CAW5BE2L.js";import"./chunk-ZYCILUCF.js";import{a as u}from"./chunk-HJOLI3MG.js";import"./chunk-QXY3EU54.js";import{a as I}from"./chunk-FCCJEZP2.js";import{a as $}from"./chunk-6VRQKJFS.js";import"./chunk-HICISBVP.js";import"./chunk-26UHRUB3.js";import{a as f}from"./chunk-26456K5W.js";import"./chunk-VSL3QDZM.js";import"./chunk-EOYPFHZC.js";import{b as ot}from"./chunk-HER2H3SF.js";import{a as tt}from"./chunk-6B3DM6A5.js";import"./chunk-7ZWGKBJM.js";import"./chunk-VPIAW7TM.js";import"./chunk-CKDBE4RR.js";import{a as J}from"./chunk-GCWYQAXJ.js";import{a as X}from"./chunk-QND5YPLT.js";import{b as W,c as Y,d as z}from"./chunk-UHBRQJNJ.js";import{d as K}from"./chunk-KWW52NRT.js";import{f as q}from"./chunk-S2E5UWT4.js";import{a as B}from"./chunk-XNSUDY5I.js";import{a as i,c as H,d as m,e as g,f as U}from"./chunk-HMXGNDLA.js";import{a as V}from"./chunk-V7XA5C77.js";import"./chunk-DGHOUIXA.js";import"./chunk-Q2UJZ7OW.js";import{b as G}from"./chunk-U7V5VQ2T.js";import{e as d}from"./chunk-NVZ5L4JK.js";var st=new i,at=new et,pt=new H,lt=new H,mt=new i,ft=new i,ut=new i,M=new i,yt=new i,ht=new i,nt=new q,dt=new g,gt=new g,Pt=new i;function wt(t,e,n,o,r,a,s,c,l){let p=t.positions,u=ot.triangulate(t.positions2D,t.holes);u.length<3&&(u=[0,1,2]);let m=J.createTypedArray(p.length,u.length);m.set(u);let h=dt;if(0!==o){let t=q.fromAxisAngle(s,o,nt);if(h=g.fromQuaternion(t,h),e.tangent||e.bitangent){t=q.fromAxisAngle(s,-o,nt);let n=g.fromQuaternion(t,gt);c=i.normalize(g.multiplyByVector(n,c,c),c),e.bitangent&&(l=i.normalize(i.cross(s,c,l),l))}}else h=g.clone(g.IDENTITY,h);let y=lt;e.st&&(y.x=n.x,y.y=n.y);let f=p.length,k=3*f,x=new Float64Array(k),w=e.normal?new Float32Array(k):void 0,j=e.tangent?new Float32Array(k):void 0,A=e.bitangent?new Float32Array(k):void 0,v=e.st?new Float32Array(2*f):void 0,P=0,_=0,F=0,L=0,b=0;for(let i=0;i<f;i++){let t=p[i];if(x[P++]=t.x,x[P++]=t.y,x[P++]=t.z,e.st)if(d(r)&&r.positions.length===f)v[b++]=r.positions[i].x,v[b++]=r.positions[i].y;else{let e=g.multiplyByVector(h,t,st),o=a(e,pt);H.subtract(o,y,o);let i=V.clamp(o.x/n.width,0,1),r=V.clamp(o.y/n.height,0,1);v[b++]=i,v[b++]=r}e.normal&&(w[_++]=s.x,w[_++]=s.y,w[_++]=s.z),e.tangent&&(j[L++]=c.x,j[L++]=c.y,j[L++]=c.z),e.bitangent&&(A[F++]=l.x,A[F++]=l.y,A[F++]=l.z)}let T=new X;return e.position&&(T.position=new z({componentDatatype:B.DOUBLE,componentsPerAttribute:3,values:x})),e.normal&&(T.normal=new z({componentDatatype:B.FLOAT,componentsPerAttribute:3,values:w})),e.tangent&&(T.tangent=new z({componentDatatype:B.FLOAT,componentsPerAttribute:3,values:j})),e.bitangent&&(T.bitangent=new z({componentDatatype:B.FLOAT,componentsPerAttribute:3,values:A})),e.st&&(T.st=new z({componentDatatype:B.FLOAT,componentsPerAttribute:2,values:v})),new Y({attributes:T,indices:m,primitiveType:W.TRIANGLES})}function x(t){t=t??U.EMPTY_OBJECT;let e=t.polygonHierarchy,n=t.textureCoordinates;G.defined("options.polygonHierarchy",e);let o=t.vertexFormat??f.DEFAULT;this._vertexFormat=f.clone(o),this._polygonHierarchy=e,this._stRotation=t.stRotation??0,this._ellipsoid=m.clone(t.ellipsoid??m.default),this._workerName="createCoplanarPolygonGeometry",this._textureCoordinates=n,this.packedLength=u.computeHierarchyPackedLength(e,i)+f.packedLength+m.packedLength+(d(n)?u.computeHierarchyPackedLength(n,H):1)+2}x.fromPositions=function(t){t=t??U.EMPTY_OBJECT,G.defined("options.positions",t.positions);let e={polygonHierarchy:{positions:t.positions},vertexFormat:t.vertexFormat,stRotation:t.stRotation,ellipsoid:t.ellipsoid,textureCoordinates:t.textureCoordinates};return new x(e)},x.pack=function(t,e,n){return G.typeOf.object("value",t),G.defined("array",e),n=n??0,n=u.packPolygonHierarchy(t._polygonHierarchy,e,n,i),m.pack(t._ellipsoid,e,n),n+=m.packedLength,f.pack(t._vertexFormat,e,n),n+=f.packedLength,e[n++]=t._stRotation,d(t._textureCoordinates)?n=u.packPolygonHierarchy(t._textureCoordinates,e,n,H):e[n++]=-1,e[n++]=t.packedLength,e};var _t=m.clone(m.UNIT_SPHERE),At=new f,bt={polygonHierarchy:{}};x.unpack=function(t,e,n){G.defined("array",t),e=e??0;let o=u.unpackPolygonHierarchy(t,e,i);e=o.startingIndex,delete o.startingIndex;let r=m.unpack(t,e,_t);e+=m.packedLength;let a=f.unpack(t,e,At);e+=f.packedLength;let s=t[e++],c=-1===t[e]?void 0:u.unpackPolygonHierarchy(t,e,H);d(c)?(e=c.startingIndex,delete c.startingIndex):e++;let l=t[e++];return d(n)||(n=new x(bt)),n._polygonHierarchy=o,n._ellipsoid=m.clone(r,n._ellipsoid),n._vertexFormat=f.clone(a,n._vertexFormat),n._stRotation=s,n._textureCoordinates=c,n.packedLength=l,n},x.createGeometry=function(t){let e=t._vertexFormat,n=t._polygonHierarchy,o=t._stRotation,r=t._textureCoordinates,a=d(r),s=n.positions;if(s=tt(s,i.equalsEpsilon,!0),s.length<3)return;let c=mt,l=ft,p=ut,m=yt,h=ht;if(!Q.computeProjectTo2DArguments(s,M,m,h))return;if(c=i.cross(m,h,c),c=i.normalize(c,c),!i.equalsEpsilon(M,i.ZERO,V.EPSILON6)){let e=t._ellipsoid.geodeticSurfaceNormal(M,Pt);i.dot(c,e)<0&&(c=i.negate(c,c),m=i.negate(m,m))}let g=Q.createProjectPointsTo2DFunction(M,m,h),y=Q.createProjectPointTo2DFunction(M,m,h);e.tangent&&(l=i.clone(m,l)),e.bitangent&&(p=i.clone(h,p));let f=u.polygonsFromHierarchy(n,a,g,!1),k=f.hierarchy,x=f.polygons,w=function(t){return t},j=a?u.polygonsFromHierarchy(r,!0,w,!1).polygons:void 0;if(0===k.length)return;s=k[0].outerRing;let A=K.fromPoints(s),H=u.computeBoundingRectangle(c,y,s,o,at),v=[];for(let i=0;i<x.length;i++){let t=new I({geometry:wt(x[i],e,H,o,a?j[i]:void 0,y,c,l,p)});v.push(t)}let P=$.combineInstances(v)[0];P.attributes.position.values=new Float64Array(P.attributes.position.values),P.indices=J.createTypedArray(P.attributes.position.values.length/3,P.indices);let _=P.attributes;return e.position||delete _.position,new Y({attributes:_,indices:P.indices,primitiveType:P.primitiveType,boundingSphere:A})};var Z=x;function kt(t,e){return d(e)&&(t=Z.unpack(t,e)),Z.createGeometry(t)}var Xt=kt;export{Xt as default};